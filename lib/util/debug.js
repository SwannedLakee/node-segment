"use strict";
/**
 * Created by user on 2018/4/19/019.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.toHex = exports.token_add_info = exports.debug_token = exports.debugToken = exports.clearTokemDebug = exports.SYMBOL_DEBUG_KEY = void 0;
const POSTAG_1 = require("../POSTAG");
const sort_object_keys2_1 = require("sort-object-keys2");
//export const SYMBOL_DEBUG_KEY = Symbol.for('_debug');
exports.SYMBOL_DEBUG_KEY = '_debug';
function clearTokemDebug(data, returnClone) {
    if (returnClone) {
        return {
            w: data.w,
            p: data.p,
            f: data.f,
        };
    }
    for (let k in data) {
        if (k != 'w' && k != 'p' && k != 'f') {
            delete data[k];
        }
    }
    delete data[exports.SYMBOL_DEBUG_KEY];
    return data;
}
exports.clearTokemDebug = clearTokemDebug;
function debugToken(data, attr, returnToken, ...argv) {
    if (attr) {
        data[exports.SYMBOL_DEBUG_KEY] = Object.assign(data[exports.SYMBOL_DEBUG_KEY] || {}, attr);
    }
    if (returnToken) {
        return data;
    }
    return (data[exports.SYMBOL_DEBUG_KEY] || {});
}
exports.debugToken = debugToken;
function debug_token(ks, returnSource) {
    let ks2 = [];
    // @ts-ignore
    ks.map(function (v, index) {
        //v.index = index;
        // @ts-ignore
        debugToken(v, {
            index,
        });
        if (v.p) {
            // @ts-ignore
            token_add_info(v);
        }
        else if (v.m) {
            // @ts-ignore
            v.m.map(token_add_info);
        }
        else {
            // @ts-ignore
            ks2.push(v);
        }
    });
    return returnSource ? ks : ks2;
}
exports.debug_token = debug_token;
function token_add_info(v) {
    if (v.p) {
        v.ps = POSTAG_1.POSTAG.zhName(v.p);
        //v.ps_en = POSTAG.enName(v.p);
        let debug = debugToken(v, {
            ps_en: POSTAG_1.POSTAG.enName(v.p),
        });
        v.pp = toHex(v.p);
        if (v.op) {
            v.ops = POSTAG_1.POSTAG.zhName(v.op);
            v.opp = toHex(v.op);
        }
        if (v.m) {
            v.m.map(function (v) {
                if (typeof v == 'string') {
                    return v;
                }
                return token_add_info(v);
            });
        }
        if (debug._source) {
            token_add_info(debug._source);
        }
    }
    if (v) {
        sort_object_keys2_1.default(v, {
            keys: [
                'w',
                'p',
                'f',
                'ps',
                'pp',
                'ow',
                'op',
                'ops',
                'opp',
                'os',
            ],
            useSource: true,
        });
    }
    return v;
}
exports.token_add_info = token_add_info;
function toHex(p) {
    return '0x' + p
        .toString(16)
        .padStart(4, '0')
        .toUpperCase();
}
exports.toHex = toHex;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVidWcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJkZWJ1Zy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7OztBQUVILHNDQUFtQztBQUVuQyx5REFBK0M7QUFFL0MsdURBQXVEO0FBQzFDLFFBQUEsZ0JBQWdCLEdBQUcsUUFBUSxDQUFDO0FBb0N6QyxTQUFnQixlQUFlLENBQUMsSUFBb0IsRUFBRSxXQUFxQjtJQUUxRSxJQUFJLFdBQVcsRUFDZjtRQUNDLE9BQU87WUFDTixDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFDVCxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFDVCxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDVCxDQUFDO0tBQ0Y7SUFFRCxLQUFLLElBQUksQ0FBQyxJQUFJLElBQUksRUFDbEI7UUFDQyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksR0FBRyxFQUNwQztZQUNDLE9BQU8sSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ2Y7S0FDRDtJQUVELE9BQU8sSUFBSSxDQUFDLHdCQUFnQixDQUFDLENBQUM7SUFFOUIsT0FBTyxJQUFhLENBQUM7QUFDdEIsQ0FBQztBQXRCRCwwQ0FzQkM7QUFVRCxTQUFnQixVQUFVLENBQWlELElBQU8sRUFDakYsSUFBeUIsRUFDekIsV0FBcUIsRUFBRSxHQUFHLElBQUk7SUFHOUIsSUFBSSxJQUFJLEVBQ1I7UUFDQyxJQUFJLENBQUMsd0JBQWdCLENBQUMsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyx3QkFBZ0IsQ0FBQyxJQUFJLEVBQUUsRUFBRSxJQUFJLENBQUMsQ0FBQztLQUMzRTtJQUVELElBQUksV0FBVyxFQUNmO1FBQ0MsT0FBTyxJQUFJLENBQUM7S0FDWjtJQUVELE9BQU8sQ0FBQyxJQUFJLENBQUMsd0JBQWdCLENBQUMsSUFBSSxFQUFFLENBQW1CLENBQUM7QUFDekQsQ0FBQztBQWhCRCxnQ0FnQkM7QUFFRCxTQUFnQixXQUFXLENBQXVCLEVBQVksRUFBRSxZQUFzQjtJQUVyRixJQUFJLEdBQUcsR0FBMEIsRUFBRSxDQUFDO0lBRXBDLGFBQWE7SUFDYixFQUFFLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxFQUFFLEtBQUs7UUFFeEIsa0JBQWtCO1FBRWxCLGFBQWE7UUFDYixVQUFVLENBQUMsQ0FBQyxFQUFFO1lBQ2IsS0FBSztTQUNMLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxDQUFDLENBQUMsRUFDUDtZQUNDLGFBQWE7WUFDYixjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDbEI7YUFDSSxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQ1o7WUFDQyxhQUFhO1lBQ2IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsY0FBYyxDQUFDLENBQUM7U0FDeEI7YUFFRDtZQUNDLGFBQWE7WUFDYixHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ1o7SUFDRixDQUFDLENBQUMsQ0FBQztJQUVILE9BQU8sWUFBWSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztBQUNoQyxDQUFDO0FBaENELGtDQWdDQztBQUVELFNBQWdCLGNBQWMsQ0FBdUIsQ0FBSTtJQUV4RCxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQ1A7UUFDQyxDQUFDLENBQUMsRUFBRSxHQUFHLGVBQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzFCLCtCQUErQjtRQUUvQixJQUFJLEtBQUssR0FBRyxVQUFVLENBQUMsQ0FBQyxFQUFFO1lBQ3pCLEtBQUssRUFBRSxlQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDekIsQ0FBQyxDQUFDO1FBRUgsQ0FBQyxDQUFDLEVBQUUsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRWxCLElBQUksQ0FBQyxDQUFDLEVBQUUsRUFDUjtZQUNDLENBQUMsQ0FBQyxHQUFHLEdBQUcsZUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDNUIsQ0FBQyxDQUFDLEdBQUcsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1NBQ3BCO1FBRUQsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUNQO1lBQ0MsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDO2dCQUVsQixJQUFJLE9BQU8sQ0FBQyxJQUFJLFFBQVEsRUFDeEI7b0JBQ0MsT0FBTyxDQUFDLENBQUM7aUJBQ1Q7Z0JBRUQsT0FBTyxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDMUIsQ0FBQyxDQUFDLENBQUM7U0FDSDtRQUVELElBQUksS0FBSyxDQUFDLE9BQU8sRUFDakI7WUFDQyxjQUFjLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQzlCO0tBQ0Q7SUFFRCxJQUFJLENBQUMsRUFDTDtRQUNDLDJCQUFjLENBQUMsQ0FBQyxFQUFFO1lBQ2pCLElBQUksRUFBRTtnQkFDTCxHQUFHO2dCQUNILEdBQUc7Z0JBQ0gsR0FBRztnQkFFSCxJQUFJO2dCQUNKLElBQUk7Z0JBRUosSUFBSTtnQkFDSixJQUFJO2dCQUNKLEtBQUs7Z0JBQ0wsS0FBSztnQkFFTCxJQUFJO2FBQ0o7WUFFRCxTQUFTLEVBQUUsSUFBSTtTQUNmLENBQUMsQ0FBQztLQUNIO0lBRUQsT0FBTyxDQUFDLENBQUM7QUFDVixDQUFDO0FBOURELHdDQThEQztBQUVELFNBQWdCLEtBQUssQ0FBQyxDQUFTO0lBRTlCLE9BQU8sSUFBSSxHQUFHLENBQUM7U0FDYixRQUFRLENBQUMsRUFBRSxDQUFDO1NBQ1osUUFBUSxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUM7U0FDaEIsV0FBVyxFQUFFLENBQ2I7QUFDSCxDQUFDO0FBUEQsc0JBT0MiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyZWF0ZWQgYnkgdXNlciBvbiAyMDE4LzQvMTkvMDE5LlxuICovXG5cbmltcG9ydCB7IFBPU1RBRyB9IGZyb20gJy4uL1BPU1RBRyc7XG5pbXBvcnQgeyBJV29yZCB9IGZyb20gJy4uL3NlZ21lbnQvdHlwZXMnO1xuaW1wb3J0IHNvcnRPYmplY3RLZXlzIGZyb20gJ3NvcnQtb2JqZWN0LWtleXMyJztcblxuLy9leHBvcnQgY29uc3QgU1lNQk9MX0RFQlVHX0tFWSA9IFN5bWJvbC5mb3IoJ19kZWJ1ZycpO1xuZXhwb3J0IGNvbnN0IFNZTUJPTF9ERUJVR19LRVkgPSAnX2RlYnVnJztcblxuZXhwb3J0IHR5cGUgSVdvcmREZWJ1Z0luZm88VCBleHRlbmRzIElXb3JkRGVidWcgPSBJV29yZERlYnVnPiA9IHtcblx0Wmh0U3lub255bU9wdGltaXplcj86IGJvb2xlYW4sXG5cdGNvbnZlcnRTeW5vbnltPzogYm9vbGVhbixcblx0YXV0b0NyZWF0ZT86IGJvb2xlYW4sXG5cblx0X3NvdXJjZT86IFQgJiBJV29yZERlYnVnLFxuXG5cdGluZGV4PzogbnVtYmVyLFxuXHRwc19lbj86IHN0cmluZyxcblxuXHRba2V5OiBzdHJpbmddOiBhbnksXG5cdFtrZXk6IG51bWJlcl06IGFueSxcbn1cblxuZXhwb3J0IHR5cGUgSVdvcmREZWJ1ZyA9IElXb3JkICYge1xuXG5cdG0/OiBBcnJheTxJV29yZERlYnVnIHwgc3RyaW5nPixcblxuXHRwcz86IHN0cmluZyxcblx0cHA/OiBzdHJpbmcsXG5cblx0b3c/OiBzdHJpbmcsXG5cdG9wPzogbnVtYmVyLFxuXHRvcHM/OiBzdHJpbmcsXG5cdG9wcD86IHN0cmluZyxcblxuXHRvcz86IGJvb2xlYW4sXG5cblx0W1NZTUJPTF9ERUJVR19LRVldPzogSVdvcmREZWJ1Z0luZm88SVdvcmREZWJ1Zz4sXG59XG5cbi8vIEB0cy1pZ25vcmVcbmV4cG9ydCBmdW5jdGlvbiBjbGVhclRva2VtRGVidWcoZGF0YTogSVdvcmREZWJ1Z0luZm8sIHJldHVybkNsb25lPzogZmFsc2UpOiBkYXRhIGlzIElXb3JkXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJUb2tlbURlYnVnKGRhdGE6IElXb3JkRGVidWdJbmZvLCByZXR1cm5DbG9uZT86IHRydWUpOiBJV29yZFxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVG9rZW1EZWJ1ZyhkYXRhOiBJV29yZERlYnVnSW5mbywgcmV0dXJuQ2xvbmU/OiBib29sZWFuKTogSVdvcmRcbntcblx0aWYgKHJldHVybkNsb25lKVxuXHR7XG5cdFx0cmV0dXJuIHtcblx0XHRcdHc6IGRhdGEudyxcblx0XHRcdHA6IGRhdGEucCxcblx0XHRcdGY6IGRhdGEuZixcblx0XHR9O1xuXHR9XG5cblx0Zm9yIChsZXQgayBpbiBkYXRhKVxuXHR7XG5cdFx0aWYgKGsgIT0gJ3cnICYmIGsgIT0gJ3AnICYmIGsgIT0gJ2YnKVxuXHRcdHtcblx0XHRcdGRlbGV0ZSBkYXRhW2tdO1xuXHRcdH1cblx0fVxuXG5cdGRlbGV0ZSBkYXRhW1NZTUJPTF9ERUJVR19LRVldO1xuXG5cdHJldHVybiBkYXRhIGFzIElXb3JkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVidWdUb2tlbjxUIGV4dGVuZHMgSVdvcmREZWJ1ZywgVSBleHRlbmRzIElXb3JkRGVidWdJbmZvPihkYXRhOiBULFxuXHRhdHRyOiBVICYgSVdvcmREZWJ1Z0luZm8sXG5cdHJldHVyblRva2VuOiB0cnVlLCAuLi5hcmd2XG4pOiBUXG5leHBvcnQgZnVuY3Rpb24gZGVidWdUb2tlbjxUIGV4dGVuZHMgSVdvcmREZWJ1ZywgVSBleHRlbmRzIElXb3JkRGVidWdJbmZvPihkYXRhOiBULFxuXHRhdHRyPzogVSAmIElXb3JkRGVidWdJbmZvLFxuXHRyZXR1cm5Ub2tlbj86IGJvb2xlYW4sIC4uLmFyZ3Zcbik6IFUgJiBJV29yZERlYnVnSW5mb1xuZXhwb3J0IGZ1bmN0aW9uIGRlYnVnVG9rZW48VCBleHRlbmRzIElXb3JkRGVidWcsIFUgZXh0ZW5kcyBJV29yZERlYnVnSW5mbz4oZGF0YTogVCxcblx0YXR0cj86IFUgJiBJV29yZERlYnVnSW5mbyxcblx0cmV0dXJuVG9rZW4/OiBib29sZWFuLCAuLi5hcmd2XG4pXG57XG5cdGlmIChhdHRyKVxuXHR7XG5cdFx0ZGF0YVtTWU1CT0xfREVCVUdfS0VZXSA9IE9iamVjdC5hc3NpZ24oZGF0YVtTWU1CT0xfREVCVUdfS0VZXSB8fCB7fSwgYXR0cik7XG5cdH1cblxuXHRpZiAocmV0dXJuVG9rZW4pXG5cdHtcblx0XHRyZXR1cm4gZGF0YTtcblx0fVxuXG5cdHJldHVybiAoZGF0YVtTWU1CT0xfREVCVUdfS0VZXSB8fCB7fSkgYXMgSVdvcmREZWJ1Z0luZm87XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWJ1Z190b2tlbjxUIGV4dGVuZHMgSVdvcmREZWJ1Zz4oa3M6IEFycmF5PFQ+LCByZXR1cm5Tb3VyY2U/OiBib29sZWFuKTogQXJyYXk8VCB8IElXb3JkRGVidWc+XG57XG5cdGxldCBrczI6IEFycmF5PFQgfCBJV29yZERlYnVnPiA9IFtdO1xuXG5cdC8vIEB0cy1pZ25vcmVcblx0a3MubWFwKGZ1bmN0aW9uICh2LCBpbmRleClcblx0e1xuXHRcdC8vdi5pbmRleCA9IGluZGV4O1xuXG5cdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdGRlYnVnVG9rZW4odiwge1xuXHRcdFx0aW5kZXgsXG5cdFx0fSk7XG5cblx0XHRpZiAodi5wKVxuXHRcdHtcblx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdHRva2VuX2FkZF9pbmZvKHYpO1xuXHRcdH1cblx0XHRlbHNlIGlmICh2Lm0pXG5cdFx0e1xuXHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0di5tLm1hcCh0b2tlbl9hZGRfaW5mbyk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRrczIucHVzaCh2KTtcblx0XHR9XG5cdH0pO1xuXG5cdHJldHVybiByZXR1cm5Tb3VyY2UgPyBrcyA6IGtzMjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRva2VuX2FkZF9pbmZvPFQgZXh0ZW5kcyBJV29yZERlYnVnPih2OiBUKVxue1xuXHRpZiAodi5wKVxuXHR7XG5cdFx0di5wcyA9IFBPU1RBRy56aE5hbWUodi5wKTtcblx0XHQvL3YucHNfZW4gPSBQT1NUQUcuZW5OYW1lKHYucCk7XG5cblx0XHRsZXQgZGVidWcgPSBkZWJ1Z1Rva2VuKHYsIHtcblx0XHRcdHBzX2VuOiBQT1NUQUcuZW5OYW1lKHYucCksXG5cdFx0fSk7XG5cblx0XHR2LnBwID0gdG9IZXgodi5wKTtcblxuXHRcdGlmICh2Lm9wKVxuXHRcdHtcblx0XHRcdHYub3BzID0gUE9TVEFHLnpoTmFtZSh2Lm9wKTtcblx0XHRcdHYub3BwID0gdG9IZXgodi5vcCk7XG5cdFx0fVxuXG5cdFx0aWYgKHYubSlcblx0XHR7XG5cdFx0XHR2Lm0ubWFwKGZ1bmN0aW9uICh2KVxuXHRcdFx0e1xuXHRcdFx0XHRpZiAodHlwZW9mIHYgPT0gJ3N0cmluZycpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRyZXR1cm4gdjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiB0b2tlbl9hZGRfaW5mbyh2KTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdGlmIChkZWJ1Zy5fc291cmNlKVxuXHRcdHtcblx0XHRcdHRva2VuX2FkZF9pbmZvKGRlYnVnLl9zb3VyY2UpO1xuXHRcdH1cblx0fVxuXG5cdGlmICh2KVxuXHR7XG5cdFx0c29ydE9iamVjdEtleXModiwge1xuXHRcdFx0a2V5czogW1xuXHRcdFx0XHQndycsXG5cdFx0XHRcdCdwJyxcblx0XHRcdFx0J2YnLFxuXG5cdFx0XHRcdCdwcycsXG5cdFx0XHRcdCdwcCcsXG5cblx0XHRcdFx0J293Jyxcblx0XHRcdFx0J29wJyxcblx0XHRcdFx0J29wcycsXG5cdFx0XHRcdCdvcHAnLFxuXG5cdFx0XHRcdCdvcycsXG5cdFx0XHRdLFxuXG5cdFx0XHR1c2VTb3VyY2U6IHRydWUsXG5cdFx0fSk7XG5cdH1cblxuXHRyZXR1cm4gdjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvSGV4KHA6IG51bWJlcilcbntcblx0cmV0dXJuICcweCcgKyBwXG5cdFx0LnRvU3RyaW5nKDE2KVxuXHRcdC5wYWRTdGFydCg0LCAnMCcpXG5cdFx0LnRvVXBwZXJDYXNlKClcblx0XHQ7XG59XG5cblxuIl19